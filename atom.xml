<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>J.Lee&#39;s Town</title>
  
  <subtitle>Life is Fantastic</subtitle>
  <link href="https://www.jaylee.top/atom.xml" rel="self"/>
  
  <link href="https://www.jaylee.top/"/>
  <updated>2021-03-09T02:28:29.641Z</updated>
  <id>https://www.jaylee.top/</id>
  
  <author>
    <name>J.Lee</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    <id>https://www.jaylee.top/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/</id>
    <published>2021-03-09T00:49:34.250Z</published>
    <updated>2021-03-09T02:28:29.641Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第一周"><a href="#第一周" class="headerlink" title="第一周"></a>第一周</h1><h2 id="2021年3月1日，Mon"><a href="#2021年3月1日，Mon" class="headerlink" title="2021年3月1日，Mon."></a>2021年3月1日，Mon.</h2><ol><li>修改论文，摘要和结论，送评阅<ul><li>X方向最大误差的情况分析：主要原因+次要原因，定性定量，数据支撑</li><li>与（检测）单线和（跟踪）DR的对比</li></ul></li></ol><h2 id="2021年3月4日，Wen"><a href="#2021年3月4日，Wen" class="headerlink" title="2021年3月4日，Wen."></a>2021年3月4日，Wen.</h2><ol><li><p>梳理论文逻辑，分析清楚问题</p><ol><li><p>量化 定位的误差。</p><p>–&gt;&gt;按照相对位置关系，更换定位的基准试试</p><p>–&gt;&gt;分析最大误差量化其构成</p></li><li><p>由单线和DR引出问题分析 –&gt;&gt; 对比性能和改善的地方</p></li></ol></li><li><p>制作PPT（3月9号）</p></li></ol><h2 id="2021-03-05，Thur"><a href="#2021-03-05，Thur" class="headerlink" title="2021-03-05，Thur."></a>2021-03-05，Thur.</h2><ol><li><h3 id="分析jiaoyun-ver2，修改算法"><a href="#分析jiaoyun-ver2，修改算法" class="headerlink" title="分析jiaoyun-ver2，修改算法"></a>分析jiaoyun-ver2，修改算法</h3><ol><li>最大误差情形1，残缺+噪点？</li></ol><p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305103614587.png" alt="image-20210305103614587" style="zoom:40%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305104721877.png" alt="image-20210305104721877" style="zoom:50%;"></p><ul><li><p>加入统计滤波看看噪声点效果如何，</p><p>== 滤波参数25\1.0，过滤太多了，调小一点. 较远的地方B车点云已经被删除了大部分。</p><p>==25\3.0,要好一些了，当噪点还是很抖动</p><p>==25\2.0, 点云太小，偏向1.0</p><p>==35/2.0，还是很小</p><p>== 40/2.5，<strong>OK</strong></p></li><li><p>长宽的拓展方向总是有错会一直抖动，会不会带来的误差比不拓展还大？</p><p>== 为啥拓展长？为了解决库位的四个点找不准？——但是拓展不准，反向之后更会造成4个点排序混乱，是否有必要？</p><p>==为啥拓展宽？为了弥补看不到圆角。感觉没啥必要，更换定位路标更重要。</p><p>== 尝试取消拓展，效果如何？</p><ul><li>无拓展</li></ul><p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305155221774.png" alt="image-20210305155221774" style="zoom:%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305155744775.png" alt="image-20210305155744775"></p><ul><li>拓展</li></ul></li></ul></li></ol><pre><code> ![image-20210305160010148](202103备忘录/image-20210305160010148.png)![image-20210305155837176](202103备忘录/image-20210305155837176.png) == 从观测值来看，*不拓展好那么一丢丢*；倒车大转角处拓展就会很差，直接失效启动行位推算了。最后位置y方向拓展会好一些 ![image-20210305175412358](202103备忘录/image-20210305175412358.png) &lt;img src=&quot;202103备忘录/image-20210305182129241.png&quot; alt=&quot;image-20210305182129241&quot; style=&quot;zoom:;&quot; /&gt;![image-20210305182202941](202103备忘录/image-20210305182202941.png) ​                                                           </code></pre><ul><li><p>按照相对位置关系判断以哪一个做为基准点？</p><p>== 对比下有switch算法和没有的差别</p></li></ul><ol start="2"><li><p>标的真值也发生了偏差，坐标转换过程中有偏差？</p><p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305103614587.png" alt="image-20210305103614587" style="zoom: 50%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305180903787.png" alt="image-20210305180903787" style="zoom:50%;"></p><p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305181419945.png" alt="image-20210305181419945" style="zoom:33%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305180903787.png" alt="image-20210305180903787" style="zoom:50%;"></p><p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305181419945.png" alt="image-20210305181419945" style="zoom:30%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305181545324.png" alt="image-20210305181545324" style="zoom: 33%;"></p><p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305181419945.png" alt="image-20210305181419945" style="zoom: 33%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305181545324.png" alt="image-20210305181545324" style="zoom:50%;"></p></li></ol>   <img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210305182025204.png" alt="image-20210305182025204" style="zoom:50%;"><h2 id="2021-03-07，Sunday"><a href="#2021-03-07，Sunday" class="headerlink" title="2021-03-07，Sunday"></a>2021-03-07，Sunday</h2><h3 id="jiaoyun-ver2分析"><a href="#jiaoyun-ver2分析" class="headerlink" title="jiaoyun-ver2分析"></a>jiaoyun-ver2分析</h3><p>最大误差，情形一，远离库位。</p><p><strong>主要原因</strong>：点云残缺，</p><p><strong>次要原因</strong>：噪点，拓展框抖动</p><ol><li><p>次要原因：噪点</p><ul><li>k/std = 70/1.0;  leafsize0.05/0.05/1.0</li></ul><p>== 噪点过滤得太猛了</p><ul><li><p>k/std = 50/1.5; </p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210307112350352.png" alt="image-20210307112350352" style="zoom:33%;"></li><li><p>voxelGrid Z-leafsize增大 </p><p>==效果聊胜于无</p></li><li><p>minimunPointsNumber（2）leafsize=0.05/0.05/2</p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210307140809379.png" alt="image-20210307140809379" style="zoom:50%;"><p>==minNumber(1) leafsize=0.04/0.04/5,很难调好，k,sd=50,2.0</p><p>==<em>放弃噪音点优化这个吧。</em></p></li></ul></li><li><p>主要原因，残缺</p><p>失效时刻1，离B车太远了残缺——<strong>ICP补全</strong>，A车库位角又残缺了——<strong>拓展宽度</strong> &amp; <strong>更换定位基准</strong></p><p>按照相对位置关系判断以哪一个做为基准点？对比下有switch算法和没有的差别？</p><ul><li><p>按照库位坐标系下自车位置，切换使用B点定位</p><p>== try1好像没起作用</p><p>== try2 滤波后，点残缺但是效果变好了,残缺厉害后，拓展也容易失效了。</p><p>==3 好像误差是小了一点点，&gt;1.5m</p></li><li><p>拓展长度容易翻转，失效</p><p>== 都拓展，然后使用B车定位，噪音稍微消除k,sd=50,1.5</p></li></ul></li></ol><ul><li><p>== 对比下有switch算法和没有的差别</p><p>==有switch &amp; 强制B车定位 无tuozhan</p><p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210307204559391.png" alt="image-20210307204559391"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210307205531194.png" alt="image-20210307205531194" style="zoom:80%;"></p><p>==无switch和强制B，有拓展</p><p>== <img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210307204851097.png" alt="image-20210307204851097" style="zoom:80%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210307205431178.png" alt="image-20210307205431178"></p><p>=有switch无强制B，有拓展</p><p><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/x.svg" alt="x" style="zoom:80%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/position.svg" alt="position" style="zoom:80%;"></p></li></ul><p>   <img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/y.svg" alt="y" style="zoom:80%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/angle.svg" alt="angle" style="zoom:80%;"></p><p>   <img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/x_err.svg" alt="x_err" style="zoom:80%;"><img src="/2021/03/09/202103%E5%A4%87%E5%BF%98%E5%BD%95/image-20210307211624706.png" alt="image-20210307211624706" style="zoom:80%;"></p><p>   ==可以看出在大误差情形1的时候，依靠残缺的B定位还没有拓展可靠；而在内部的时候有switch明显改善很多。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;第一周&quot;&gt;&lt;a href=&quot;#第一周&quot; class=&quot;headerlink&quot; title=&quot;第一周&quot;&gt;&lt;/a&gt;第一周&lt;/h1&gt;&lt;h2 id=&quot;2021年3月1日，Mon&quot;&gt;&lt;a href=&quot;#2021年3月1日，Mon&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/03/04/PPT%E5%88%B6%E4%BD%9C/"/>
    <id>https://www.jaylee.top/2021/03/04/PPT%E5%88%B6%E4%BD%9C/</id>
    <published>2021-03-04T05:46:54.821Z</published>
    <updated>2021-03-04T07:15:39.133Z</updated>
    
    <content type="html"><![CDATA[<p>合抱之木，生于毫末；九层之台，起于累土。</p><p>三部分：策划难忘、视觉设计、演讲仪式</p><h2 id="演讲"><a href="#演讲" class="headerlink" title="演讲"></a>演讲</h2><p>以观众的思维演讲，文字数据可视化，避免单向交流。整体的逻辑。</p><h2 id="PPT-演讲自检清单"><a href="#PPT-演讲自检清单" class="headerlink" title="PPT 演讲自检清单"></a>PPT 演讲自检清单</h2><table><thead><tr><th>演讲的主题：</th><th align="left"></th></tr></thead><tbody><tr><td>观众情况</td><td align="left"></td></tr><tr><td>观众最想听的三点</td><td align="left"></td></tr><tr><td>观众最不能接受的</td><td align="left"></td></tr><tr><td>提前试听并确认过这些吗？</td><td align="left">动画、时间、衔接、PPT页面完整、顺利打开播放、字体展示</td></tr><tr><td>开场方式</td><td align="left">普通、互动、多媒体、自我介绍</td></tr><tr><td>如何打造个人特色</td><td align="left">表演、服装、号召</td></tr><tr><td>演讲是否有令人难忘的举动句子？</td><td align="left">什么形式？多少？</td></tr><tr><td>收尾的方式？</td><td align="left">祝福？首尾呼应？</td></tr><tr><td>我觉得观众会记住哪3点？</td><td align="left"></td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;合抱之木，生于毫末；九层之台，起于累土。&lt;/p&gt;
&lt;p&gt;三部分：策划难忘、视觉设计、演讲仪式&lt;/p&gt;
&lt;h2 id=&quot;演讲&quot;&gt;&lt;a href=&quot;#演讲&quot; class=&quot;headerlink&quot; title=&quot;演讲&quot;&gt;&lt;/a&gt;演讲&lt;/h2&gt;&lt;p&gt;以观众的思维演讲，文字数据可视化</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>旋转</title>
    <link href="https://www.jaylee.top/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/"/>
    <id>https://www.jaylee.top/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/</id>
    <published>2021-02-23T07:05:47.000Z</published>
    <updated>2021-06-24T15:46:16.382Z</updated>
    
    <content type="html"><![CDATA[<h1 id="旋转基础"><a href="#旋转基础" class="headerlink" title="旋转基础"></a>旋转基础</h1><p>转载链接：<a href="https://www.cnblogs.com/21207-iHome/p/6894128.html">https://www.cnblogs.com/21207-iHome/p/6894128.html</a></p><h2 id="RPY角与Z-Y-X欧拉角"><a href="#RPY角与Z-Y-X欧拉角" class="headerlink" title="RPY角与Z-Y-X欧拉角"></a><strong>RPY角与Z-Y-X欧拉角</strong></h2><p>　　描述坐标系{B}相对于参考坐标系{A}的姿态有两种方式。第一种是<strong>绕固定（参考）坐标轴旋转</strong>：假设开始两个坐标系重合，先将{B}绕{A}的X轴旋转$\lambda$，然后绕{A}的Y轴旋转 $\beta$ ，最后绕{A}的Z轴旋转$\alpha$，就能旋转到当前姿态。可以称其为X-Y-Z fixed angles或RPY角(Roll, Pitch, Yaw)。</p><a id="more"></a><p>Roll:横滚</p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/890966-20170525140304841-1105765244.gif" alt="img" style="zoom:50%;"><p>　　Pitch: 俯仰</p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/890966-20170525140116919-1889606213.gif" alt="img" style="zoom:50%;"><p>Yaw: 偏航（航向）</p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/890966-20170525140337654-1615043244.gif" alt="img" style="zoom:50%;"><p>由于是绕固定坐标系旋转，则旋转矩阵为（$c\alpha$ is shorthand for $\cos\alpha$, $s\alpha$ is shorthand for $\sin\alpha$,and so on.）<br>$$<br>R_{XYZ}(\gamma,\beta,\alpha)=R_Z(\alpha)R_Y(\beta)R_X(\gamma)=\begin{bmatrix}<br>c\alpha c\beta &amp; c\alpha s\beta s\gamma-s\alpha c\gamma &amp; c\alpha s\beta c\gamma+s\alpha s\gamma\<br>s\alpha c\beta &amp; s\alpha s\beta s\gamma+c\alpha c\gamma &amp; s\alpha s\beta c\gamma-c\alpha s\gamma\<br>-s\beta&amp; c\beta s\gamma &amp; c\beta c\gamma<br>\end{bmatrix}<br>$$<br>　　另一种姿态描述方式是<strong>绕自身坐标轴旋转</strong>：假设开始两个坐标系重合，先将{B}绕自身的Z轴旋转$\alpha$，然后绕Y轴旋转$\beta$，最后绕X轴旋转$\gamma$，就能旋转到当前姿态。称其为Z-Y-X欧拉角，由于是绕自身坐标轴进行旋转，则旋转矩阵为：<br>$$<br>R_{Z’Y’X’}(\alpha,\beta,\gamma)=R_Z(\alpha)R_Y(\beta)R_X(\gamma)=\begin{bmatrix}<br>c\alpha c\beta &amp; c\alpha s\beta s\gamma-s\alpha c\gamma &amp; c\alpha s\beta c\gamma+s\alpha s\gamma\<br>s\alpha c\beta &amp; s\alpha s\beta s\gamma+c\alpha c\gamma &amp; s\alpha s\beta c\gamma-c\alpha s\gamma\<br>-s\beta&amp; c\beta s\gamma &amp; c\beta c\gamma<br>\end{bmatrix}<br>$$<br>　　可以发现这两种描述方式得到的旋转矩阵是一样的，即绕固定坐标轴X-Y-Z旋转$(\gamma,\beta,\alpha)$和绕自身坐标轴Z-Y-X旋转$(\alpha,\beta,\gamma)$的最终结果一样，只是描述的方法有差别而已。In gerenal: three rotations taken about fixed axes yield the same final orientation as the same three rotations taken in opposite order about the axes of the moving frame.</p><h2 id="Axis-Angle与四元数"><a href="#Axis-Angle与四元数" class="headerlink" title="Axis-Angle与四元数"></a><strong>Axis-Angle与四元数</strong></h2><p>　　绕坐标轴的多次旋转可以等效为绕某一转轴旋转一定的角度。假设等效旋转轴方向向量为$\vec{K}=[k_x,k_y,k_z]^T$，等效旋转角为$\theta$，则四元数$q=(x,y,z,w)$，其中：</p><p>$$\begin{align*}<br>x &amp;= k_x \cdot sin \frac{\theta}{2}\<br>y &amp;= k_y \cdot sin \frac{\theta}{2}\<br>z &amp;= k_z \cdot sin \frac{\theta}{2}\<br>w &amp;= cos \frac{\theta}{2}<br>\end{align*}$$</p><p>　　且有$x^2+y^2+z^2+w^2=1$</p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/quaternion.png" alt="img"></p><p>　　即四元数存储了旋转轴和旋转角的信息，它能方便的描述刚体绕任意轴的旋转。</p><p>　　四元数转换为旋转矩阵：</p><p>$$R=\begin{bmatrix}<br>1-2y^2-2z^2 &amp; 2(xy-zw) &amp; 2(xz+yw)\<br>2(xy+zw) &amp; 1-2x^2-2z^2 &amp; 2(yz-xw)\<br>2(xz-yw)&amp; 2(yz+xw) &amp; 1-2x^2-2y^2<br>\end{bmatrix}$$</p><p> 　已知旋转矩阵为：</p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/890966-20170525130817779-2094968004.png" alt="img"></p><p>　　则对应的四元数为：</p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/890966-20170525130848716-419557543.png" alt="img"></p><hr><h2 id="四元数与欧拉角的相互转换"><a href="#四元数与欧拉角的相互转换" class="headerlink" title="四元数与欧拉角的相互转换"></a><strong>四元数与欧拉角的相互转换</strong></h2><p>　　定义两个四元数：</p><p>　　<img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/14ce36d3d539b60003b31a9feb50352ac65cb79c.jpg" alt="img"></p><p>　　<img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/8cb1cb1349540923a2da76569058d109b3de4962.jpg" alt="img"></p><p>　　其中<img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/7dd98d1001e939017bae981679ec54e736d1966d.jpg" alt="img"> 表示矢量 </p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/63d0f703918fa0ec052e7125249759ee3d6ddb28.jpg" alt="img"> </p><p> ；而 </p><p> <img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/a8014c086e061d95f4ec221079f40ad162d9ca74.jpg" alt="img"></p><p> 表示矢量 </p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/9c16fdfaaf51f3dedb19ac4c96eef01f3a29796a.jpg" alt="img"> </p><p><strong>四元数加法：</strong></p><p>　　跟复数、向量和矩阵一样，两个四元数之和需要将不同的元素加起来。</p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/d01373f082025aaf6ace6be3f9edab64034f1a1d.jpg" alt="img"></p><p>　　加法遵循实数和复数的所有交换律和结合律。</p><p><strong>四元数乘法：</strong></p><p>　　四元数的乘法的意义类似于矩阵的乘法，可以表示旋转的合成。当有多次旋转操作时，使用四元数可以获得更高的计算效率。</p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/7e3e6709c93d70cf36be3013fbdcd100baa12b63.jpg" alt="img"></p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/54fbb2fb43166d2233909989452309f79152d2cc.jpg" alt="img"></p><p>　　由于四元数乘法的非可换性，pq并不等于qp，qp乘积的向量部分是：</p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/72f082025aafa40f75cb4bc3a864034f78f0199a.jpg" alt="img"></p><p>　　</p><p>　　Mathematica中有四元数相关的程序包<a href="https://reference.wolfram.com/language/Quaternions/tutorial/Quaternions.html"><strong>Quaternions Package</strong></a>，需要先导入才能使用。下面计算了三个四元数的乘积：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;Quaternions&#96;     （* This loads the package *）</span><br><span class="line">Quaternion[2, 1, 1, 3] ** Quaternion[2, 1, 1, 0] ** Quaternion[1, 1, 1, 1]    (* Be sure to use ** rather than * when multiplying quaternions *)</span><br></pre></td></tr></table></figure><p>　　计算结果为：Quaternion[-12, 4, 14, 2]</p><p>　　那么将Z-Y-X欧拉角（或RPY角：绕固定坐标系的X-Y-Z依次旋转$\alpha$,$\beta$,$\gamma$角）转换为四元数：</p><p>$$q=\begin{bmatrix}\cos\frac{\gamma}{2}\ 0\ 0\ \sin\frac{\gamma}{2}\end{bmatrix} \begin{bmatrix}\cos\frac{\beta}{2}\ 0\ \sin\frac{\beta}{2}\ 0\end{bmatrix} \begin{bmatrix}\cos\frac{\alpha}{2}\ \sin \frac{\alpha}{2}\ 0\ 0\end{bmatrix}=\begin{bmatrix}<br>\cos\frac{\alpha}{2}\cos\frac{\beta}{2}\cos\frac{\gamma}{2}+\sin\frac{\alpha}{2}\sin\frac{\beta}{2}\sin\frac{\gamma}{2}\<br>\sin\frac{\alpha}{2}\cos\frac{\beta}{2}\cos\frac{\gamma}{2}-\cos\frac{\alpha}{2}\sin\frac{\beta}{2}\sin\frac{\gamma}{2}\ \cos\frac{\alpha}{2}\sin\frac{\beta}{2}\cos\frac{\gamma}{2}+\sin\frac{\alpha}{2}\cos\frac{\beta}{2}\sin\frac{\gamma}{2}<br>\ \cos\frac{\alpha}{2}\cos\frac{\beta}{2}\sin\frac{\gamma}{2}-\sin\frac{\alpha}{2}\sin\frac{\beta}{2}\cos\frac{\gamma}{2}<br>\end{bmatrix}$$</p><p> 　根据上面的公式可以求出逆解，即由四元数$q=(q_0,q_1,q_2,q_3)$或$q=(w,x,y,z)$到欧拉角的转换为：</p><p>$$\begin{bmatrix}\alpha\ \beta\ \gamma\end{bmatrix} = \begin{bmatrix}<br>\arctan\frac{2(q_0q_1+q_2q_3)}{1-2(q_1^2+q_2^2)}\<br>\arcsin(2(q_0q_2-q_1q_3))\<br>\arctan\frac{2(q_0q_3+q_1q_2)}{1-2(q_2^2+q_3^2)}<br>\end{bmatrix}$$</p><p>　　由于arctan和arcsin的取值范围在$\frac{-\pi}{2}$和$\frac{\pi}{2}$之间，只有180°，而绕某个轴旋转时范围是360°，因此要使用**<a href="http://baike.baidu.com/link?url=-tnNm1Iop3YKgo3EKf4OpaAPSC6KsyMS3trChz3oL3fsTTqFsXt8Y6oX_anPYoMa8EO9tJ7eSRnK1LiuFF4Jma">atan2</a>**函数代替arctan函数：</p><p>$$\begin{bmatrix}\alpha\ \beta\ \gamma\end{bmatrix} = \begin{bmatrix}<br>atan2(2(q_0q_1+q_2q_3),1-2(q_1^2+q_2^2))\<br>\arcsin(2(q_0q_2-q_1q_3))\<br>atan2(2(q_0 q_3+q_1 q_2),1-2(q_2^2+q_3^2))<br>\end{bmatrix}$$</p><p>对于tan(θ) = y / x ：</p><p>　　θ = ATan(y / x)求出的θ取值范围是[-PI/2, PI/2]；</p><p>　　θ = ATan2(y, x)求出的θ取值范围是[-PI,  PI]。</p><ul><li><p>当 (x, y) 在第一象限, 0 &lt; θ &lt; PI/2</p></li><li><p>当 (x, y) 在第二象限 PI/2 &lt; θ≤PI</p></li><li><p>当 (x, y) 在第三象限, -PI &lt; θ &lt; -PI/2</p></li><li><p>当 (x, y) 在第四象限, -PI/2 &lt; θ &lt; 0</p><p>　将<a href="http://bediyap.com/programming/convert-quaternion-to-euler-rotations/">四元数转换为欧拉角</a>可以参考下面的代码。需要注意<strong>欧拉角有12种旋转次序</strong>，而上面推导的公式是按照Z-Y-X顺序进行的，所以有时会在网上看到不同的转换公式（因为对应着不同的旋转次序），在使用时一定要注意旋转次序是什么。比如ADAMS软件里就默认Body 3-1-3次序，即Z-X-Z欧拉角，而VREP中则按照X-Y-Z欧拉角旋转。</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enum RotSeq&#123;zyx, zyz, zxy, zxz, yxz, yxy, yzx, yzy, xyz, xyx, xzy,xzx&#125;;</span><br></pre></td></tr></table></figure><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/ContractedBlock.gif" alt="img"> View Code</p><p>　　 上面的代码存在一个问题，即奇异性没有考虑。下面看一种特殊的情况（参考<a href="http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToEuler/index.htm">Maths - Conversion Quaternion to Euler</a>）：假设一架飞机绕Y轴旋转了90°（俯仰角pitch=90），机头垂直向上，此时如何计算航向角和横滚角？</p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/890966-20170526171944435-256526740.png" alt="img" style="zoom:50%;"><p>　　这时会发生自由度丢失的情况，即Yaw和Roll会变为一个自由度。此时再使用上面的公式根据四元数计算欧拉角会出现问题：</p><p>　　$\arcsin(2(q_0q_2-q_1q_3))$的定义域为$[-1,1]$，因此$(q_0q_2-q_1q_3)\in[-0.5, 0.5]$，当$q_0q_2-q_1q_3=0.5$时（在程序中浮点数不能直接进行等于判断，要使用合理的阈值），俯仰角$\beta$为90°，将其带入正向公式计算出四元数$(q_0,q_1,q_2,q_3)$，然后可以发现逆向公式中atan2函数中的参数全部为0，即出现了$\frac{0}{0}$的情况！无法计算。</p><p>　　$\beta=\pi/2$时，$\sin\frac{\beta}{2}=\cos\frac{\beta}{2}=0.707$，将其带入公式中有</p><p>$$q=\begin{bmatrix}w\ x\ y\ z\end{bmatrix}<br>\begin{bmatrix}<br>0.707(\cos\frac{\alpha}{2}\cos\frac{\gamma}{2}+\sin\frac{\alpha}{2}\sin\frac{\gamma}{2})\<br>0.707(\sin\frac{\alpha}{2}\cos\frac{\gamma}{2}-\cos\frac{\alpha}{2}\sin\frac{\gamma}{2})\<br>0.707(\cos\frac{\alpha}{2}\cos\frac{\gamma}{2}+\sin\frac{\alpha}{2}\sin\frac{\gamma}{2})\<br>0.707(\cos\frac{\alpha}{2}\sin\frac{\gamma}{2}-\sin\frac{\alpha}{2}\cos\frac{\gamma}{2})<br>\end{bmatrix}=<br>\begin{bmatrix}<br>0.707\cos\frac{\alpha-\gamma}{2}\<br>0.707\sin\frac{\alpha-\gamma}{2}\<br>0.707\cos\frac{\alpha-\gamma}{2}\<br>0.707\sin\frac{\alpha-\gamma}{2}<br>\end{bmatrix}$$</p><p>　　则$\frac{x}{w}=\frac{z}{y}=\tan\frac{\alpha-\gamma}{2}$，于是有</p><p>$$\alpha-\gamma = 2\cdot atan2(x,w)$$</p><p> 　通常令$\alpha=0$，这时$\gamma = -2\cdot atan2(x,w)$。可以进行验证：当四元数为(w,x,y,z)=(0.653,-0.271,0.653,0.271)时，根据这些规则计算出来的ZYX欧拉角为α=0°，β=90°，γ=45°</p><p><a href="http://quaternions.online/"><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/890966-20170526175726669-1601154856.png" alt="img"></a></p><p>　　当俯仰角为-90°，即机头竖直向下时的情况也与之类似，可以推导出奇异姿态时的计算公式。比较完整的四元数转欧拉角（Z-Y-X order）的代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">CameraSpacePoint QuaternionToEuler(Vector4 q) &#x2F;&#x2F; Z-Y-X Euler angles</span><br><span class="line">&#123;</span><br><span class="line">    CameraSpacePoint euler &#x3D; &#123; 0 &#125;;</span><br><span class="line">    const double Epsilon &#x3D; 0.0009765625f;</span><br><span class="line">    const double Threshold &#x3D; 0.5f - Epsilon;</span><br><span class="line"></span><br><span class="line">    double TEST &#x3D; q.w*q.y - q.x*q.z;</span><br><span class="line"></span><br><span class="line">    if (TEST &lt; -Threshold || TEST &gt; Threshold) &#x2F;&#x2F; 奇异姿态,俯仰角为±90°</span><br><span class="line">    &#123;</span><br><span class="line">        int sign &#x3D; Sign(TEST);</span><br><span class="line"></span><br><span class="line">        euler.Z &#x3D; -2 * sign * (double)atan2(q.x, q.w); &#x2F;&#x2F; yaw</span><br><span class="line"></span><br><span class="line">        euler.Y &#x3D; sign * (PI &#x2F; 2.0); &#x2F;&#x2F; pitch</span><br><span class="line"></span><br><span class="line">        euler.X &#x3D; 0; &#x2F;&#x2F; roll</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        euler.X &#x3D; atan2(2 * (q.y*q.z + q.w*q.x), q.w*q.w - q.x*q.x - q.y*q.y + q.z*q.z);</span><br><span class="line">        euler.Y &#x3D; asin(-2 * (q.x*q.z - q.w*q.y));</span><br><span class="line">        euler.Z &#x3D; atan2(2 * (q.x*q.y + q.w*q.z), q.w*q.w + q.x*q.x - q.y*q.y - q.z*q.z);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    return euler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>　　在DirectXMath Library中有许多与刚体姿态变换相关的函数可以直接调用：</p><ul><li><p>四元数乘法：<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.quaternion.xmquaternionmultiply(v=vs.85).aspx">XMQuaternionMultiply</a> method –Computes the product of two quaternions.</p></li><li><p>旋转矩阵转四元数：<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.quaternion.xmquaternionrotationmatrix(v=vs.85).aspx">XMQuaternionRotationMatrix</a> method –Computes a rotation quaternion from a rotation matrix.</p></li><li><p>四元数转旋转矩阵：<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.matrix.xmmatrixrotationquaternion(v=vs.85).aspx">XMMatrixRotationQuaternion</a> method – Builds a rotation matrix from a quaternion.</p></li><li><p>欧拉角转四元数：<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.quaternion.xmquaternionrotationrollpitchyaw(v=vs.85).aspx">XMQuaternionRotationRollPitchYaw</a> method –Computes a rotation quaternion based on the pitch, yaw, and roll (Euler angles).</p></li><li><p>四元数转Axis-Angle：<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.quaternion.xmquaterniontoaxisangle(v=vs.85).aspx">XMQuaternionToAxisAngle</a> method –Computes an axis and angle of rotation about that axis for a given quaternion.</p></li><li><p>欧拉角转旋转矩阵：<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.matrix.xmmatrixrotationrollpitchyaw(v=vs.85).aspx">XMMatrixRotationRollPitchYaw method</a> –Builds a rotation matrix based on a given pitch, yaw, and roll (Euler angles).</p></li><li><p>Axis-Angle转旋转矩阵：<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.matrix.xmmatrixrotationaxis(v=vs.85).aspx">XMMatrixRotationAxis</a> method –Builds a matrix that rotates around an arbitrary axis.</p></li><li><p>构造绕X/Y/Z轴的旋转矩阵：<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.matrix.xmmatrixrotationx(v=vs.85).aspx?f=255&MSPPError=-2147217396">XMMatrixRotationX</a> method –Builds a matrix that rotates around the x-axis.(Angles are measured clockwise when looking along the rotation axis toward the origin)</p><p>　下面的代码中坐标系绕X轴旋转90°（注意这里不是按照右手定则的方向，而是沿着坐标轴向原点看过去以顺时针方式旋转，因此与传统的右手定则刚好方向相反），来进行变换：</p></li></ul><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/ContractedBlock.gif" alt="img"> View Code</p><p>　　结果如下图所示:</p><p><img src="/2021/02/23/%E3%80%90todo%E3%80%91%E6%97%8B%E8%BD%AC/890966-20170526093436138-366855659.png" alt="img"></p><p>参考：</p><p><a href="http://quaternions.online/">quaternions.online</a></p><p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ee415597(v=vs.85).aspx">DirectXMath Library Quaternion Functions</a></p><p><a href="http://bediyap.com/programming/convert-quaternion-to-euler-rotations/">Convert quaternion to euler rotations</a></p><p><a href="https://en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles">Conversion between quaternions and Euler angles</a></p><p><a href="http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToEuler/index.htm">Maths - Conversion Quaternion to Euler</a></p><p><strong><a href="http://cn.mathworks.com/help/robotics/gs/coordinate-systems-in-robotics.html">Coordinate Transformations in Robotics—MATLAB</a></strong></p><p><strong><em>Introduction to Robotics - Mechanics and Control.</em></strong> Chapter 2 Spatial descriptions and transformations</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;旋转基础&quot;&gt;&lt;a href=&quot;#旋转基础&quot; class=&quot;headerlink&quot; title=&quot;旋转基础&quot;&gt;&lt;/a&gt;旋转基础&lt;/h1&gt;&lt;p&gt;转载链接：&lt;a href=&quot;https://www.cnblogs.com/21207-iHome/p/6894128.html&quot;&gt;https://www.cnblogs.com/21207-iHome/p/6894128.html&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;RPY角与Z-Y-X欧拉角&quot;&gt;&lt;a href=&quot;#RPY角与Z-Y-X欧拉角&quot; class=&quot;headerlink&quot; title=&quot;RPY角与Z-Y-X欧拉角&quot;&gt;&lt;/a&gt;&lt;strong&gt;RPY角与Z-Y-X欧拉角&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;　　描述坐标系{B}相对于参考坐标系{A}的姿态有两种方式。第一种是&lt;strong&gt;绕固定（参考）坐标轴旋转&lt;/strong&gt;：假设开始两个坐标系重合，先将{B}绕{A}的X轴旋转$\lambda$，然后绕{A}的Y轴旋转 $\beta$ ，最后绕{A}的Z轴旋转$\alpha$，就能旋转到当前姿态。可以称其为X-Y-Z fixed angles或RPY角(Roll, Pitch, Yaw)。&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/02/16/%E3%80%90ROS%E3%80%91Parameter%20server/"/>
    <id>https://www.jaylee.top/2021/02/16/%E3%80%90ROS%E3%80%91Parameter%20server/</id>
    <published>2021-02-15T16:31:31.550Z</published>
    <updated>2021-02-15T16:31:31.550Z</updated>
    
    <content type="html"><![CDATA[<h2 id="roslaunch"><a href="#roslaunch" class="headerlink" title="roslaunch"></a>roslaunch</h2><p>param <code>name=</code>+<code>value=</code></p><p>rosparam <code>file=</code>+<code>command=</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;roslaunch&quot;&gt;&lt;a href=&quot;#roslaunch&quot; class=&quot;headerlink&quot; title=&quot;roslaunch&quot;&gt;&lt;/a&gt;roslaunch&lt;/h2&gt;&lt;p&gt;param &lt;code&gt;name=&lt;/code&gt;+&lt;code&gt;value=&lt;/cod</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/02/16/%E3%80%90ROS%E3%80%91%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    <id>https://www.jaylee.top/2021/02/16/%E3%80%90ROS%E3%80%91%E5%A4%9A%E7%BA%BF%E7%A8%8B/</id>
    <published>2021-02-15T16:31:31.550Z</published>
    <updated>2021-02-15T16:31:31.550Z</updated>
    
    <content type="html"><![CDATA[<p>ROS:: spin()</p><p>ROS::spinOnce()</p><p>ROS::MultiThreadedSpinner</p><p>ROS::AsyncSpinner</p><p>ros::CallbackQueue::callAvailable() / ::callOne()</p><p>std::thread process{func, argument}</p><p>std::queue&lt; &gt; x</p><p>std::mutex </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ROS:: spin()&lt;/p&gt;
&lt;p&gt;ROS::spinOnce()&lt;/p&gt;
&lt;p&gt;ROS::MultiThreadedSpinner&lt;/p&gt;
&lt;p&gt;ROS::AsyncSpinner&lt;/p&gt;
&lt;p&gt;ros::CallbackQueue::callAvailable() </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/02/16/%E3%80%90Python%E3%80%91matplotlib&amp;pandas/"/>
    <id>https://www.jaylee.top/2021/02/16/%E3%80%90Python%E3%80%91matplotlib&amp;pandas/</id>
    <published>2021-02-15T16:31:31.550Z</published>
    <updated>2021-02-15T16:31:31.550Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/dev-liu/p/pandas_plt_basic.html">https://www.cnblogs.com/dev-liu/p/pandas_plt_basic.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/dev-liu/p/pandas_plt_basic.html&quot;&gt;https://www.cnblogs.com/dev-liu/p/pandas_plt_basic.html&lt;/a&gt;&lt;/p&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/02/16/%E3%80%90%E5%AE%9E%E9%AA%8C%E7%9B%B8%E5%85%B3%E3%80%91/"/>
    <id>https://www.jaylee.top/2021/02/16/%E3%80%90%E5%AE%9E%E9%AA%8C%E7%9B%B8%E5%85%B3%E3%80%91/</id>
    <published>2021-02-15T16:31:31.550Z</published>
    <updated>2021-02-15T16:31:31.550Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Kvaser"><a href="#Kvaser" class="headerlink" title="Kvaser"></a>Kvaser</h1><p><a href="https://github.com/astuff/kvaser_interface">https://github.com/astuff/kvaser_interface</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;?xml</span> <span class="string">version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="string">&lt;launch&gt;</span></span><br><span class="line">  <span class="string">&lt;arg</span> <span class="string">name=&quot;can_hardware_id&quot;</span> <span class="string">default=&quot;011683&quot;</span> <span class="string">/&gt;</span></span><br><span class="line">  <span class="string">&lt;!--</span> <span class="string">&lt;arg</span> <span class="string">name=&quot;can_circuit_id&quot;</span> <span class="string">default=&quot;2&quot;</span> <span class="string">/&gt;</span> <span class="string">--&gt;</span></span><br><span class="line">  <span class="string">&lt;arg</span> <span class="string">name=&quot;can_bit_rate&quot;</span> <span class="string">default=&quot;500000&quot;</span> <span class="string">/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="string">&lt;node</span> <span class="string">pkg=&quot;kvaser_interface&quot;</span> <span class="string">type=&quot;kvaser_can_bridge&quot;</span> <span class="string">ns=&quot;kvaser_channel_1&quot;</span> <span class="string">name=&quot;kvaser_can_bridge&quot;</span> <span class="string">output=&quot;screen&quot;&gt;</span></span><br><span class="line">    <span class="string">&lt;param</span> <span class="string">name=&quot;can_hardware_id&quot;</span> <span class="string">value=&quot;$(arg</span> <span class="string">can_hardware_id)&quot;</span> <span class="string">/&gt;</span></span><br><span class="line">    <span class="string">&lt;param</span> <span class="string">name=&quot;can_circuit_id&quot;</span> <span class="string">value=&quot;1&quot;</span> <span class="string">/&gt;</span></span><br><span class="line">    <span class="string">&lt;param</span> <span class="string">name=&quot;can_bit_rate&quot;</span> <span class="string">value=&quot;$(arg</span> <span class="string">can_bit_rate)&quot;</span> <span class="string">/&gt;</span></span><br><span class="line">  <span class="string">&lt;/node&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="string">&lt;node</span> <span class="string">pkg=&quot;kvaser_interface&quot;</span> <span class="string">type=&quot;kvaser_can_bridge&quot;</span> <span class="string">ns=&quot;kvaser_channel_2&quot;</span> <span class="string">name=&quot;kvaser_can_bridge&quot;</span> <span class="string">output=&quot;screen&quot;&gt;</span></span><br><span class="line">    <span class="string">&lt;param</span> <span class="string">name=&quot;can_hardware_id&quot;</span> <span class="string">value=&quot;$(arg</span> <span class="string">can_hardware_id)&quot;</span> <span class="string">/&gt;</span></span><br><span class="line">    <span class="string">&lt;param</span> <span class="string">name=&quot;can_circuit_id&quot;</span> <span class="string">value=&quot;2&quot;</span> <span class="string">/&gt;</span></span><br><span class="line">    <span class="string">&lt;param</span> <span class="string">name=&quot;can_bit_rate&quot;</span> <span class="string">value=&quot;$(arg</span> <span class="string">can_bit_rate)&quot;</span> <span class="string">/&gt;</span></span><br><span class="line">  <span class="string">&lt;/node&gt;</span></span><br><span class="line"><span class="string">&lt;/launch&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="采集数据"><a href="#采集数据" class="headerlink" title="采集数据"></a>采集数据</h1><ol><li>kvaser 正确链接，接口：<ul><li>CHANEL 2 接 诊断口2  RT3000数据</li><li>CHANEL 3 接 诊断口4  V3上电和VCU读码盘转向盘数据</li></ul></li><li>上电，matlab/ros驱动<ul><li><em>matlab</em>仿真时间要调成真实时间，上电的时候断开紧急开关（按下）</li><li>ros驱动指令如下</li><li><em>todo问题</em>：roskvaser_powerUp没用</li></ul></li><li>连接以太网线和路由器<ul><li>交换机供电5v，——分线器可能电压不够，利用充电宝或者工控机</li></ul></li><li>连接RT3000和千寻服务<ul><li>当精度热机到要求的时候开始记录</li></ul></li><li>启动算法</li><li>录包<ul><li>点云没有记录下来</li></ul></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">kvaser驱动</span></span><br><span class="line">roslaunch kvaser_interface kvaser_can_bridge.launch</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">控制v3上电程序</span></span><br><span class="line">rosrun lidar_percetion powerUp -i -m -d -g</span><br><span class="line"></span><br><span class="line">rosrun lidar_percetion kvaser_powerUp -i -m -d -g</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">雷达驱动</span></span><br><span class="line">roslaunch rslidar_sdk start.launch/start_three.launch</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 感知算法</span></span><br><span class="line">roslaunch lidar_perception SLAM_and_Detection.launch</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">record</span></span><br><span class="line">rosbag record  /chasis_speed /rt3000_pose /steering_angle_deg /rslidar_points /left/rslidar_points /right/rslidar_points /wheeling_count_fl_fr_rl_rr</span><br></pre></td></tr></table></figure><p><img src="/2021/02/16/%E3%80%90%E5%AE%9E%E9%AA%8C%E7%9B%B8%E5%85%B3%E3%80%91/image-20210124150913640.png" alt="image-20210124150913640"></p><p>运行一会会自动关闭</p><h2 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h2><ol><li>matplotlib 画图figure空白</li></ol><p>echo 3 &gt; /proc/sys/vm/drop_caches </p><p>echo $ DISPLAY=0.0</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Kvaser&quot;&gt;&lt;a href=&quot;#Kvaser&quot; class=&quot;headerlink&quot; title=&quot;Kvaser&quot;&gt;&lt;/a&gt;Kvaser&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/astuff/kvaser_interface&quot;&gt;h</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/02/16/%E3%80%90Linux%E3%80%91Proxy/"/>
    <id>https://www.jaylee.top/2021/02/16/%E3%80%90Linux%E3%80%91Proxy/</id>
    <published>2021-02-15T16:31:31.535Z</published>
    <updated>2021-02-15T16:31:31.550Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git config --global --unset http.proxy</span><br><span class="line">git config --global --unset https.proxy</span><br><span class="line"></span><br><span class="line">env | grep -i proxy</span><br><span class="line">unset ALL_PROXY</span><br><span class="line">unset all_proxy</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/01/14/%E6%AF%95%E4%B8%9A%E5%89%8D%E8%BF%98%E6%83%B3%E5%AD%A6%E7%9A%84/"/>
    <id>https://www.jaylee.top/2021/01/14/%E6%AF%95%E4%B8%9A%E5%89%8D%E8%BF%98%E6%83%B3%E5%AD%A6%E7%9A%84/</id>
    <published>2021-01-14T12:05:26.770Z</published>
    <updated>2021-06-24T15:44:12.453Z</updated>
    
    <content type="html"><![CDATA[<h2 id="待学清单"><a href="#待学清单" class="headerlink" title="待学清单"></a>待学清单</h2><ul><li>实验代码优化<ul><li>C++继承还没怎么用过</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;待学清单&quot;&gt;&lt;a href=&quot;#待学清单&quot; class=&quot;headerlink&quot; title=&quot;待学清单&quot;&gt;&lt;/a&gt;待学清单&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;实验代码优化&lt;ul&gt;
&lt;li&gt;C++继承还没怎么用过&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.jaylee.top/2021/01/14/%E3%80%90ROS%E3%80%91Rviz/"/>
    <id>https://www.jaylee.top/2021/01/14/%E3%80%90ROS%E3%80%91Rviz/</id>
    <published>2021-01-14T12:05:26.762Z</published>
    <updated>2021-01-14T12:05:26.763Z</updated>
    
    <content type="html"><![CDATA[<p>Rviz教程：<a href="http://wiki.ros.org/rviz/Tutorials">http://wiki.ros.org/rviz/Tutorials</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//线条</span></span><br><span class="line">visualization_msgs::Marker OV_line,PS_line;</span><br><span class="line"><span class="keyword">while</span>(ros::ok())&#123;</span><br><span class="line">    <span class="comment">//set header</span></span><br><span class="line">    OV_line.header.frame_id = PS_line.header.frame_id =  header_parkingSlot.frame_id;</span><br><span class="line">    OV_line.header.stamp = PS_line.header.stamp = header_parkingSlot.stamp;</span><br><span class="line">    OV_line.ns = PS_line.ns = <span class="string">&quot;rslidar_perception&quot;</span>;</span><br><span class="line">    OV_line.action = PS_line.action = visualization_msgs::Marker::ADD;</span><br><span class="line">    OV_line.pose.orientation.w = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">    OV_line.id = <span class="number">0</span>;</span><br><span class="line">    PS_line.id = <span class="number">1</span>;</span><br><span class="line">    OV_line.type = PS_line.type = visualization_msgs::Marker::LINE_STRIP;</span><br><span class="line"></span><br><span class="line">    OV_line.scale.x=<span class="number">0.1</span>;</span><br><span class="line">    PS_line.scale.x = <span class="number">0.1</span>;</span><br><span class="line">    OV_line.color.b = <span class="number">1.0</span>;</span><br><span class="line">    PS_line.color.r = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">    OV_line.points.push_back()</span><br><span class="line">        geometry_msgs::Point P_PS,P_OV;</span><br><span class="line">    P_PS.x = PS_pose_filtered[<span class="number">0</span>]+<span class="number">1.5</span>*<span class="built_in">cos</span>(PS_pose_filtered[<span class="number">2</span>]);</span><br><span class="line">    P_PS.y = PS_pose_filtered[<span class="number">1</span>]+<span class="number">1.5</span>*<span class="built_in">sin</span>(PS_pose_filtered[<span class="number">2</span>]);</span><br><span class="line">    P_PS.z = <span class="number">0</span>;</span><br><span class="line">    PS_line.points.push_back(P_PS);</span><br><span class="line">    P_PS.x = PS_pose_filtered[<span class="number">0</span>];</span><br><span class="line">    P_PS.y = PS_pose_filtered[<span class="number">1</span>];</span><br><span class="line">    PS_line.points.push_back(P_PS);</span><br><span class="line">    P_PS.x = PS_pose_filtered[<span class="number">0</span>]+<span class="number">2.5</span>*<span class="built_in">cos</span>(PS_pose_filtered[<span class="number">2</span>]-M_PI_2);</span><br><span class="line">    P_PS.y = PS_pose_filtered[<span class="number">1</span>]+<span class="number">2.5</span>*<span class="built_in">sin</span>(PS_pose_filtered[<span class="number">2</span>]-M_PI_2);</span><br><span class="line">    PS_line.points.push_back(P_PS);</span><br><span class="line"></span><br><span class="line">    P_OV.x = OV_pose_filtered[<span class="number">0</span>]+<span class="number">1.5</span>*<span class="built_in">cos</span>(OV_pose_filtered[<span class="number">2</span>]);</span><br><span class="line">    P_OV.y = OV_pose_filtered[<span class="number">1</span>]+<span class="number">1.5</span>*<span class="built_in">sin</span>(OV_pose_filtered[<span class="number">2</span>]);</span><br><span class="line">    P_OV.z = <span class="number">0</span>;</span><br><span class="line">    OV_line.points.push_back(P_OV);</span><br><span class="line">    P_OV.x = OV_pose_filtered[<span class="number">0</span>];</span><br><span class="line">    P_OV.y = OV_pose_filtered[<span class="number">1</span>];</span><br><span class="line">    OV_line.points.push_back(P_OV);</span><br><span class="line">    P_OV.x = OV_pose_filtered[<span class="number">0</span>]+<span class="number">2.5</span>*<span class="built_in">cos</span>(OV_pose_filtered[<span class="number">2</span>]-M_PI_2);</span><br><span class="line">    P_OV.y = OV_pose_filtered[<span class="number">1</span>]+<span class="number">2.5</span>*<span class="built_in">sin</span>(OV_pose_filtered[<span class="number">2</span>]-M_PI_2);</span><br><span class="line">    OV_line.points.push_back(P_OV);</span><br><span class="line"></span><br><span class="line">    tracked_slot_marker_pub.publish(PS_line);</span><br><span class="line">    marker_pub.publish(OV_line);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 用箭头来代替有向点</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Rviz教程：&lt;a href=&quot;http://wiki.ros.org/rviz/Tutorials&quot;&gt;http://wiki.ros.org/rviz/Tutorials&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;</summary>
      
    
    
    
    
  </entry>
  
</feed>
