---
title:磁盘读写结束后弹出提示
date: 2020-07-010 15:17:49
categories:
- 工具技能
tags:
- win10磁盘监控
- DIAS实习
---



## 1. 配置性能监控器监控项

https://www.skyarch.cn/blog/windows/monitor-perfmon-tool/

常用监控对象和计数器:

https://blog.csdn.net/snlei/article/details/54091275

https://www.jianshu.com/p/f4406c29542a

我们使用**物理磁盘对象(PhysicalDisk Object)**下的Avg.Disk Write Queue Length(平均磁盘写队列长度)。

物理磁盘对象提供了有关物理磁盘I / O性能的信息。它的磁盘计数器与系统中的物理驱动器有关，并且只有当运行了diskper服务时，它才被激活。注意与**逻辑磁盘对象**进行区别。这个对象下的计数器如下所示：

**1.** 磁盘读时间百分比(％Disk Read Time) 选中的物理磁盘忙于服务读请求总共用的时间的百分比。

**2.** 磁盘写时间百分比(％Disk Write Time) 选中的物理磁盘忙于服务写请求总共用的时间的百分比。

**3.** 磁盘时间百分比(％Disk Time) 选中的物理磁盘忙于服务读请求或写请求总共用的时间的百分比，是磁盘写时间百分比与磁盘读时间百分比的和。

**4.** 空闲时间百分比(％Idle Time) 物理磁盘在采样时间间隔中处于空闲状态的时间百分比。

**5.** 平均磁盘队列长度( Avg. Disk Queue Length) 在采样的时间间隔中，选中的物理磁盘读请求和写请求排队的平均数量。

**6.** 平均磁盘读队列长度( Avg. Disk Read Queue Length) 在采样的时间间隔中，选中的物理磁盘读请求排队的平均数量。

**7.** 平均磁盘写队列长度( Avg. Disk Write Queue Length) 在采样的时间间隔中，选中的物理磁盘写请求排队的平均数量。

**8.** 平均磁盘秒数/读( Avg. Disk sec/Read) 从物理磁盘读数据的平均时间，以秒为单位。

**9.** 平均磁盘秒数/写( Avg. Disk sec/Write) 向物理磁盘写数据的平均时间，以秒为单位。

**10.** 平均磁盘秒数/传输( Avg. Disk sec/Transfer) 从物理磁盘进行传输的平均时间，以秒为单位。

**11.** 磁盘读/秒(Disk Reads Bytes/sec) 物理磁盘上每秒读字节。

**12.** 磁盘写/秒(Disk Writes Bytes/sec) 物理磁盘上每秒写字节。

**13.** 磁盘读/秒(Disk Reads/sec) 物理磁盘上的读操作比率。

**14.** 磁盘写/秒(Disk Writes/sec) 物理磁盘上的写操作比率。

**15.** 磁盘传输/秒(Disk Transfers/sec) 物理磁盘上的读和写操作的比率。

## 2. 创建警报计划任务，关联监控数据收集器集

[利用Win10计划任务 + 弹窗提醒](https://www.cnblogs.com/yourstars/p/6505991.html)

**弹窗提示**：*.bat代码：

```bat
echo off
start mshta vbscript:msgbox("Go to work, stupid dog!!",0,"Sound from eval")(window.close)
```

注意不要有中文和中文路径。

**发送邮件提示**：SmtpMailSender通过命令行发送邮件，别用QQ邮箱，安全验证麻烦。

创建一个文本文件，命名为 perfalert.cmd，同样保存在 d:smtp 目录中，其内容格式为：

```cmd
smtpmailsender.exe -f "发件人地址" -t "收件人地址" -s "邮件标题" -b "邮件正文" -send
```

其余步骤：https://www.skyarch.cn/blog/windows/monitor-perfmon-tool/